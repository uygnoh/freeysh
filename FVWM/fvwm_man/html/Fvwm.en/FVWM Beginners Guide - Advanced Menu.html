<html><head>
<meta http-equiv="content-type" content="text/html; charset=windows-1252">
<title>FVWM Beginners Guide - Advanced Menu</title>
<link rel="stylesheet" href="FVWM%20Beginners%20Guide%20-%20Advanced%20Menu_files/fvwm.css">
</head>

<body>
<p>Menus are useful tools and can be generated dynamically in FVWM. The FvwmExpose
function on the last page is an example of that. One of the nice thing about
FVWM menus is being able to create them from scripts. This is nice because you could
create a menu based off the wallpapers in a directory (example already shown), or
you could create a menu that list all the contents of the directory (and its subdirectories).
Some places to look for more information about this is to check out the
fvwm-menu-directory and fvwm-menu-headlines scripts that come with FVWM
(complete with man pages). Also look up MissingSubmenuFunction, DynamicPopupAction and
DynamicPopdownAction in the FVWM man page.</p>

<p><a href="http://zensites.net/fvwm/guide/debian.org">Debian</a> is my distro of choice. One nice tool that comes with debian
is the 'menu' package which is used to generate menus. The FVWM debian package comes
with a script that takes advantage of this to generate a menu of the installed apps
on your debian box. I have taken this script and modified to my own liking and use
it to generate a DebianMenu on my desktop. If you have debian and are interested in this
you'll need to grab the following three files: <a href="http://zensites.net/fvwm/guide/files/fvwm_menu">fvwm_menu</a>,
<a href="http://zensites.net/fvwm/guide/files/fvwm_menu.h">fvwm_menu.h</a> and <a href="http://zensites.net/fvwm/guide/files/fvwm_menu_data.h">
fvwm_menu_data.h</a>. Then you'll have to put these files in your
$[fvwm_scrpt] directory. After that you'll also need to add the following function
to your fvwm2rc.</p>

<center><table cellpadding="10" border="1" width="400">
<tbody><tr><td valign="center">
<pre><font color="#0000ff">#####</font>
<font color="#0000ff"># DebianMenu</font>
<font color="#0000ff">###########</font>
<font color="#008b8b">DestroyFunc</font> BuildDebianMenu
<font color="#008b8b">AddToFunc</font>   BuildDebianMenu
+ I <font color="#008b8b">Exec</font> if [ -f <font color="#ff00ff">"$[fvwm_home]/DebianMenu"</font> ] then rm <font color="#a020f0">$[fvwm_home]</font>/DebianMenu fi
+ I <font color="#008b8b">PipeRead</font> 'update-menus --menumethod <font color="#a020f0">$[fvwm_scrpt]</font>/fvwm_menu; \
  cat <font color="#a020f0">$[fvwm_home]</font>/DebianMenu'
</pre>
</td></tr></tbody></table></center>

<p>Though the use of the menu package this function creates a file called $HOME/.fvwm/DebianMenu.
If you use another location as your $[fvwm_home] you'll have to modify the fvwm_menu script slightly.
It then cats the file and uses it to create the DebianMenu. I have this set up so you have to
run the function BuildDebianMenu anytime the menu needs to be updated, but the nice thing about it
is all you have to do is 'Read $[fvwm_home]/DebianMenu' at startup to include this menu in
your setup. To get to the menu, just add it to your FvwmRootMenu and 'Popup DebianMenu'.</p>

<p>For the next example, I have modified the script fvwm-menu-directory to use to create
myself a MediaMenu to list my music. I suggest you first take a look at both the
fvwm-menu-directory and fvwm-menu-headlines man page first. The following is an example for
a modified version of <a href="http://zensites.net/fvwm/guide/files/fvwm-menu-directory">fvwm-menu-directory</a>. I have two main
features I added to the script. The first one is for any directory it will look for a file
called [directory_name].png and if it finds one it will use that image as the Icon for
that directory in the menu (and in the title of the submenu generated by that directory), along with this
feature I have set it up so you can ignore all .png files and not list them in the menu.
The second feature I have added is the ability to only list parts of the directory, so the menu
doesn't get too big. Before I explain how these work lets first look at the FuncFvwmMenuDirectory
that is used to generate these functions and the 'MediaMenu' that spawns them.</p>

<center><table cellpadding="10" border="1" width="400">
<tbody><tr><td valign="center">
<pre><font color="#008b8b">DestroyFunc</font> FuncFvwmMenuDirectory
<font color="#008b8b">AddToFunc</font>   FuncFvwmMenuDirectory
+ I <font color="#008b8b">PipeRead</font> '<font color="#a020f0">$[fvwm_scrpt]</font>/fvwm-menu-directory --title <font color="#ff00ff">"%d"</font> --dir <font color="#ff00ff">"$0"</font> \
  --links --command-file <font color="#ff00ff">"exec xmms \\"</font>%f\\<font color="#ff00ff">""</font> \
  --command-title <font color="#ff00ff">"exec xmms \\"</font>%d\\<font color="#ff00ff">""</font> \
  --icon-title <font color="#ff00ff">"$0.png"</font> --icon-file <font color="#ff00ff">"menu/notes.png"</font> \
  --exclude <font color="#ff00ff">".png"</font>'

<font color="#0000ff">#####</font>
<font color="#0000ff"># MediaMenu</font>
<font color="#0000ff">###########</font>
<font color="#008b8b">DestroyMenu</font> MusicMenu
<font color="#008b8b">AddToMenu</font>   MusicMenu <font color="#ff00ff">"Music"</font> <font color="#008b8b">Title</font>
<font color="#008b8b">AddToMenu</font>   MusicMenu <font color="#6a5acd">MissingSubmenuFunction</font> FuncFvwmMenuDirectory
+ <font color="#ff00ff">"Artists A-B</font><font color="#0000ff">%menu/music.xpm%</font><font color="#ff00ff">"</font> <font color="#008b8b">Popup</font> /home/music/albums/artists|[14AB]
+ <font color="#ff00ff">"Artists C-G</font><font color="#0000ff">%menu/music.xpm%</font><font color="#ff00ff">"</font> <font color="#008b8b">Popup</font> /home/music/albums/artists|[CDEFG]
+ <font color="#ff00ff">"Artists H-K</font><font color="#0000ff">%menu/music.xpm%</font><font color="#ff00ff">"</font> <font color="#008b8b">Popup</font> /home/music/albums/artists|[HIJK]
+ <font color="#ff00ff">"Artists L-O</font><font color="#0000ff">%menu/music.xpm%</font><font color="#ff00ff">"</font> <font color="#008b8b">Popup</font> /home/music/albums/artists|[LMNO]
+ <font color="#ff00ff">"Artists P-S</font><font color="#0000ff">%menu/music.xpm%</font><font color="#ff00ff">"</font> <font color="#008b8b">Popup</font> /home/music/albums/artists|[PQRS]
+ <font color="#ff00ff">"Artists T-Z</font><font color="#0000ff">%menu/music.xpm%</font><font color="#ff00ff">"</font> <font color="#008b8b">Popup</font> /home/music/albums/artists|[TUVWXYZ]
+ <font color="#ff00ff">"Unsorted</font><font color="#0000ff">%menu/music.xpm%</font><font color="#ff00ff">"</font> <font color="#008b8b">Popup</font> /home/music/albums/unsorted
+ <font color="#ff00ff">"Assorted Music</font><font color="#0000ff">%menu/music.xpm%</font><font color="#ff00ff">"</font> <font color="#008b8b">Popup</font> /home/music/assorted
+ <font color="#ff00ff">"Collections</font><font color="#0000ff">%menu/music.xpm%</font><font color="#ff00ff">"</font> <font color="#008b8b">Popup</font> /home/music/albums/collections
+ <font color="#ff00ff">"Soundtracks</font><font color="#0000ff">%menu/music.xpm%</font><font color="#ff00ff">"</font> <font color="#008b8b">Popup</font> /home/music/albums/soundtracks
</pre>
</td></tr></tbody></table></center>

<p>How the MediaMenu works is it sets up FuncFvwmMenuDirectory as the MissingSubmenuFunction.
What this does is if you try to Popup a submenu that doesn't exist, it will send the name of the
submenu to the FuncFvwmMenuDirectory. That function then generates the submenu so it can be PopedUp.
How my FuncFvwmMenuDirectory works is it takes a directory name followed by the list of
the starting letters of the items to include. For example, 'Popup /home/music/albums/artists|[CDEFG]'
will only list the files/directories in /home/music/albums/artists that start with C, D, E, F or G.
<a href="http://zensites.net/fvwm/guide/fvwm-menu-directory.png">Here</a> is an example of what this will look like.</p>


<hr>
<table cellpadding="0" border="0" width="100%">
<tbody><tr><td align="left" width="33%"><a href="http://zensites.net/fvwm/guide/advanced_functions.html">Advanced Functions</a></td>
<td align="center" width="34%"><a href="http://zensites.net/fvwm/guide/index.html">index</a></td>
<td align="right" width="33%"><a href="http://zensites.net/fvwm/guide/advanced_buttons.html">Advanced FvwmButtons</a></td></tr></tbody></table>


</body></html>