###########################################################
### % SDCC - Small Device C Compiler
###########################################################
1 % 安装SDCC
$ sudo apt-get install sdcc


2 % 安装STlink驱动


###########################################################
### % 安装stm8flash =>STM8
###########################################################
git clone https://github.com/vdudouyt/stm8flash.git
cd stm8flash
make
sudo make install



###########################################################
### % 安装stcflash =>MCS8051
###########################################################
% stcflash可以中github直接下载到本地，加入环境变量即可
wget https://github.com/laborer/stcflash/archive/master.zip
unzip stcflash-master.zip
cd stcflash-master
mv stcflash.py stcflash
sudo mv stcflash /usr/local/bin
% 然后安装stcflash的依赖包
sudo apt install python-serial


% STC8051单片机例程
% 需要注意的是:
% sdcc中所有非C标准关键字都以两个下划线开头单个引脚的表示使用下划线表示，
% 例如P3_2，与keil的^不同引用的头文件为mcs51/8051.h
#include <mcs51/8051.h>
void main()
{
  __bit status = 1;
  while(1)
  {
    P0_0 = status;
    status = !status;
    delay(1000);
  }
}


1 % 编译程序和生成hex文件
sdcc main.c -o main.ihx

2 % sdcc编译之后直接得到的是ihx文件，并不是51单片机需要的hex文件，所以需要使用packihx命令打包
  % packihx命令是在安装sdcc的时候附带安装的，所以可以直接使用。
packihx main.ihx > main.hex

3 % 烧写程序到单片机, 烧写的时候需要重新给单片机上电
sudo stcflash --port /dev/ttyUSB0 main.hex
    


